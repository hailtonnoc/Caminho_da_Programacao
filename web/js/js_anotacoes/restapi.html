<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>API's</title>
</head>
<body>
    <header>
        <h1>API's Rest</h1>
        <p>Estado de Transferência representativo.</p>
    </header>

    <main>
        <section class="entendendo">
            <h2>Estados</h2>
            <h3>Entidades</h3>
            <p>Os dados circularam entre <strong>Servidor <i>REST</i></strong> e <strong>Cliente</strong> essa articulação sera realizada sempre por uma <i>requisição</i> que devolvera sempre uma <i>resposta</i>.</p>
            <p>Essas serão direcionadas sempres aos <i>verbos HTTP</i> (get, post, delete, patch). E cada um desses verbos estão relacionados a <i>end-points</i> ou simplesmente <i>URL's</i>.</p>
            <p>Requisições e Respostas geralmente transitam em formato JSON, mas podem assumir tranquilamente outros formatos como: XML, FormData, URLEncoded...</p>


        </section>

        <section class="configurando">

            <div class="instalandomd">
                <h2>Preparando Ambiente</h2>
                <p>No terminal:</p>
                <h3>JSON</h3>
                <p>Para iniciar o projeto utilize o <abbr title="Node Package Manager">npm</abbr> com o comando <strong>init</strong> ou <strong>init <abbr title="JSON pré pronto">-y</abbr></strong> isso criará o arquivo package.<strong>JSON</strong> que ira abrigar todos os dados do projeto. </p>
                <code><pre>npm init</pre></code>
                
                <h3>Express</h3>
                <p>Dentro dele executaremos o servidor para isso usaremos o modulo "Express" que permite criar e executar servidores a partir dele. Sendo o corpo para requisições HTTP no NODE.</p>
                <p>O comando a ser utilizado é o <code>npm install.</code></p>
                <code><pre>npm install <strong>express</strong></pre></code>

                <details>
                    <summary>Funcionais</summary>
                    <h3>Body Parser</h3>
                    <p>converte entradas em objetos diversos JSON e JS.</p>
                    <code><pre>npm install <strong>body-parser</strong></pre></code>
                    <h3>MySQL</h3>
                    <p>Permite a conexão entre o API rest e o MySQL</p>
                    <code><pre>npm install <strong>mysql</strong></pre></code>
                    <h4>Sequelize</h4>
                    <code><pre>npm install <strong>sequelize</strong></pre></code>
                </details>
            </div>

            <div class="preparandoIndex">
                <h3>Arquivo Principal</h3>
                <p>Criado enter point geralmente utilize o nome "index.js" ou "sever.js"</p>

                <h4>Definindo Express</h4>
                <p>Chamando módulo do <strong>express</strong>, defina uma variavel para melhorar a visualização do codigo. O mesmo deve ser requerido.<br> Após defina também sua <abbr title="'app'">instância</abbr>.</p>
                <code>
                    <pre>
    const express = <strong>require('<abbr title="chamada de biblioteca">express</abbr>')</strong>
    <strong>const app = express()</strong>
                    </pre>
                </code>
                <p>Para a API funcionar defina um escutador para as requisições do servidor.<br> Esse escutador recebe uma porta e em seguida uma <a href="../js_anotacoes/jsinicio.js">Função</a> que serve como um callback simples para teste.</p>
                <code>
                    <pre>
    app<strong>.listen</strong>(<abbr title="porta">3000</abbr>, <abbr title="CALLBACK">função</abbr>)
<small>ex:</small>
    app.listen(3000, () => console.log('servidor na porta 3000 ok'))
                    </pre>
                </code>

                <h4>Definindo Body parser</h4>
                <p>O mesmo sera usado como um plugin, então após a requisição usar ele no <code>app</code> usando a chamada do <code>.json()</code> como função, pois sera o formato de trabalho.</p>
                <code>
                    <pre>
        ...
    const app = express()
    const bodyParser = <strong>require('body-parser')</strong>

    app.<strong>use(bodyParser.json())</strong>
                    </pre>
                </code>

                <h4>Comunicando com Banco de dados</h4>
                <p>Criar arquivo .js de comunicação de preferencia em uma pasta separada para conexão. O modulo <strong>Sequelize</strong> sera o responsável por essa comunicação.</p>
                <code>
                    <pre>
    const Sequelize = require('sequelize')
<small><i>declarando instância:</i></small>
    const instancia = <strong>new Sequelize()</strong>

    module.exports = instancia
                    </pre>
                </code>
                <p>As <strong>configurações</strong> do acesso ao banco de dados vai dentro da instância.</p>
                <code>
                    <pre>

        ...
    const instancia = <strong>new Sequelize(</strong><i>
            'nome_bancoDados',
            'usuario',
            'senha',
            {
                host: 'ip_maquina',
                dialect: 'tipode_BancoDados'
            }
        </i>
    <strong>)</strong>
    
    module.exports = instancia
                    </pre>
                    <pre>
        ...
    <strong>const config = require('config')</strong>
    const instancia = new Sequelize(
        config.get('mysql.banco-de-dados'),
        config.get('mysql.usuario'),
        config.get('mysql.senha'),
        {
            host: config.get('mysql.host'),
            dialect: 'mysql'
        }
    )
    
    module.exports = instancia
                    </pre>
                </code>

                <h5>Config</h5>
                <p>Modulo para isolar dados importantes em produção.</p>
                <code><pre>npm install config</pre></code>

                <p>Após a instalação do modulo escrever um objeto JSON contendo o objeto com dados de acesso a modo de ser expresso nas configurações do <strong>Sequelize.</strong></p>
                <code>
                    <pre>
    {
        "mysql":
        {
            "banco-de-dados": "nome",
            "usuario": "root",
            "senha": "123456",
            "host": "127.0.0.1"
        }
    }
                    </pre>
                </code>




                
                <h3>Exportando Modulos</h3>
                <p>Utilize o comando <code>module.exports = <small>nome => {}</small></code><br>
                para exportar instale o modulo <code>consign</code> ele ira agrupar todas as rotas e colocar tudo dentro do <strong>app</strong>.</p>
                <code>
                    <pre>
                        consign()
                        .include('<small>pasta</small>')
                        .into(app)
                    </pre>
                </code>
            </div>

            <div class="chamadas">
                <h3>Requisições</h3>
                <p>Podemos declarar no index principal mas por via de organização do código é prudente considerar colocar o comando em um arquivo separado.</p>
                <small>Lembrar sempre de referenciar o comando no arquivo principal.</small>
                <code><pre>app.use('/caminho', função(requisicao, resposta){})</pre></code>
                <p>Em um novo arquivo:</p>
                <code>
                    <pre>
    const roteador = require('express').Router()

    roteador.use('/', (requisicao, resposta) =>
    {
        resposta.send('connected')
    })

    module.exports = roteador
                    </pre>
                </code>

                <h3>Verbos HTTP</h3>
                <p>Retornar dados <code><strong>.get</strong></code>('<small>/local</small>', função)</p>
                <p>Inserir dados no servidor<code><strong>.post</strong></code>('<small>/local</small>', função)</p>
                <p>Alterar dados no servidor<code><strong>.path</strong></code>('<small>/local</small>', função)</p>
                <p>Apagar dados no servidor<code><strong>.delete</strong></code>('<small>/local</small>', função)</p>


                <p><code><strong>.send</strong></code>('<small>conteudo</small>') envia dados.</p>
    
            </div>

        </section>



        <section class="ajustando_json">
            <h2>Manipulando <code>package.json</code></h2>
            <h3><code>"scripts":</code></h3>
            <p>pode ser inserido scripts para trabalhar diretamente no terminal.</p>
            <code>
                <pre>
    <small>ex:</small>
                        <small>"stripts":</small> {
                        <strong>"start"</strong>: "node index.js",

                        <small>"test": "echo \"Error: no test specified\...</small>
                </pre>
            </code>
            <p>O mesmo é invocado no terminal com o comando <code>npm <strong>start</strong></code></p>

            <h3>Facilitando comandos</h3>

            <h4>nodemon</h4>
            <p>A biblioteca <strong>nodemon</strong> é uma boa alternativa para atualizar as alterações do servidor. <br>
            salve apenas em desenvolvimento <code>--save-dev <strong>nodemon</strong></code> para restartar o servidor utilize o comando <strong>rs</strong>.</p>

            <code>
                <pre>
        <small>configurando:</small>
                        app.<strong>use</strong>(bodyParser.urlencoded({extended:true}))
                </pre>
            </code>


            <h4>moment</h4>
            <p><code><strong>moment</strong></code>é biblioteca dedicada a trabalhar com datas, fazer calculos, manipular datas e formatar.</p>

        </section>

        <section class="littlethings">
            <div>
                <h3>Comandos no terminal</h3>
                <table border="1">
                    <thead>
                        <th>Comando</th>
                        <th>Função</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>node ./nome</td>
                            <td>inicia documento</td>
                        </tr>
                        <tr>
                            <td>ctrl + c</td>
                            <td>Derruba o servidor</td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </section>

    </main>

    <br>
    <a href="../jsindex.html" rel="prev"><img src="../../../XXXMATERIAISXXX/IMAGENS/left.png" alt="voltar"></a>
    
</body>
</html>